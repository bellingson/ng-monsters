!function(){"use strict"}(),function(){"use strict";function e(e){e.setBaseUrl("/api")}function t(e){e.when("/",{templateUrl:"monster/monsters.html",controller:"MonsterListCtrl as list"}).when("/monster/:id",{templateUrl:"monster/monster-detail.html",controller:"MonsterDetailCtrl as detail"}).when("/sell",{templateUrl:"monster/monster-sell.html",controller:"MonsterSellCtrl as sell"}).when("/sell/:id",{templateUrl:"monster/monster-sell.html",controller:"MonsterSellCtrl as sell"}).when("/cart",{templateUrl:"cart/cart.html",controller:"CartViewCtrl as cart"}).otherwise("/")}angular.module("monsterApp",["ngRoute","restangular"]),angular.module("monsterApp").config(["RestangularProvider",e]),e.$inject=["RestangularProvider"],angular.module("monsterApp").config(["$routeProvider",t]),t.$inject=["$routeProvider"]}(),function(){"use strict";function e(e){return{required:"E",link:function(t,n,r){function o(){t.cartCount=e.itemCount()}e.subscribe(o),o()},template:'<a ng-href="/#/cart" class="btn btn-warning">Checkout ({{cartCount}})</a>'}}angular.module("monsterApp").directive("cartButton",["cartService",e]),e.$inject=["cartService"]}(),function(){"use strict";function e(e,t){function n(){r()}function r(){a.monsters=e.items(),a.totalPrice=e.totalPrice()}function o(){return 0==a.monsters.length?(t.errorMessage("Your cart is empty"),!1):!0}function i(){o()&&t.message("Congratulations on your purchase")}function s(t){e.remove(t),r()}var a=this;a.checkOutClicked=i,a.removeMonster=s,n()}angular.module("monsterApp").controller("CartViewCtrl",e),e.$inject=["cartService","messageService"]}(),function(){"use strict";function e(e,t){function n(n){function r(t){var n=e.currentUser();if(t.sellerId==n.id)throw{message:"You can not buy your own monster"};var r=_.filter(c,function(e){return e.id==t.id});if(r.length>0)throw{message:t.name+" is already in your cart."};c.push(t),u.forEach(function(e){e()})}return t(function(e,t){try{r(n),e()}catch(o){t(o)}})}function r(e){_.remove(c,function(t){return t.id==e.id}),u.forEach(function(e){e()})}function o(){return c}function i(){return c.length}function s(){return _.sum(_.map(c,function(e){return e.price}))}function a(e){u=[e]}var c=[],u=[];return{add:n,remove:r,itemCount:i,items:o,totalPrice:s,subscribe:a}}angular.module("monsterApp").factory("cartService",e),e.$inject=["userService","$q"]}(),function(){"use strict";function e(e){function t(e){a.push(e)}function n(){a=[]}function r(e,t){return i("message",e,t)}function o(e,t){return i("errorMessage",e,t)}function i(t,n,r){if(n)return s={},s[t]={text:n,path:r||e.path()},void a.forEach(function(e){e()});var o=s[t];return o?(e.path()===o.path&&(s[t]=null),o.text):null}var s={},a=[];return{message:r,errorMessage:o,subscribe:t,unsubscribe:n}}angular.module("monsterApp").factory("messageService",e),e.$inject=["$location"]}(),function(){function e(e,t){return{restrict:"E",link:function(t,n,r){function o(){t.message=e.message(),t.errorMessage=e.errorMessage()}e.unsubscribe(),e.subscribe(o),o()},templateUrl:"message/messages.html"}}angular.module("monsterApp").directive("moMessages",e),e.$inject=["messageService","$location"]}(),function(){"use strict";function e(e,t,n,r,o){function i(){s(),c()}function s(){var t=e.id;n.get(t).then(function(e){u.monster=e})}function a(e){r.add(e).then(function(){o.message("Added "+e.name+" to your cart.","/"),t.path("/")},function(e){o.errorMessage(e.message)})}function c(){u.cartCount=r.itemCount()}var u=this;u.addToCart=a,i()}angular.module("monsterApp").controller("MonsterDetailCtrl",e),e.$inject=["$routeParams","$location","monsterService","cartService","messageService"]}(),function(){"use strict";function e(e,t,n,r){function o(){e.id?i():u.monster={name:"Jaws",type:"Fish",birthday:"1975/07/21",price:6e6,img:"https://upload.wikimedia.org/wikipedia/en/e/eb/JAWS_Movie_poster.jpg",description:"Jaws is a 1975 American film directed by Steven Spielberg and based on Peter Benchley's 1974 novel of the same name. The prototypical summer blockbuster, its release is regarded as a watershed moment in motion picture history. In the story, a giant man-eating great white shark attacks beachgoers on Amity Island, a fictional New England summer resort town, prompting the local police chief to hunt it with the help of a marine biologist and a professional shark hunter."}}function i(){n.get(e.id).then(function(e){u.monster=e},function(e){r.errorMessage("Failed to fetch monster")})}function s(){n.save(u.monster).then(function(){r.message("Your monster is now up for sale!","/"),t.path("/")},function(e){console.log(e),r.errorMessage("Update failed")})}function a(){t.path("/")}function c(){confirm("Are you sure you want to cancel this sale?")&&n.deleteMonster(u.monster).then(function(e){r.message("Your sale is now canceled","/"),t.path("/")},function(e){console.log(e),r.errorMessage("Update failed")})}var u=this;u.sellMonster=s,u.cancelClicked=a,u.cancelSale=c,o()}angular.module("monsterApp").controller("MonsterSellCtrl",e),e.$inject=["$routeParams","$location","monsterService","messageService"]}(),function(){"use strict";function e(){return function(e){return e?e.length<=150?e:e.substring(0,150):""}}angular.module("monsterApp").filter("monsterSummary",e)}(),function(){"use strict";function e(e){function t(t){return e.one("monster",t).get()}function n(t){if(t.id){var n=e.copy(t);return n.put()}return i.post(t)}function r(e){return e.remove()}function o(){return i.getList()}var i=e.all("monster");return{get:t,save:n,deleteMonster:r,monsters:o}}angular.module("monsterApp").factory("monsterService",e),e.$inject=["Restangular"]}(),function(){"use strict";function e(e,t,n,r,o){function i(){a(),s()}function s(){l.cartCount=n.itemCount()}function a(){t.monsters().then(function(e){l.monsters=e})}function c(e){var t=r.currentUser();return e.sellerId==t.id?!0:!1}function u(e){n.add(e).then(function(){o.message(e.name+" was added to your cart"),s()},function(e){o.errorMessage(e.message)})}var l=this;l.addToCart=u,l.canEdit=c,i()}angular.module("monsterApp").controller("MonsterListCtrl",e),e.$inject=["$location","monsterService","cartService","userService","messageService"]}(),angular.module("monsterApp").factory("userService",function(){function e(){return t}var t={id:1,name:"Jimmy"};return{currentUser:e}});